<% var theEvent = '' %>
<%- include header %>
    
    <div class="rzv-lightbox">

      <h2>Reservations</h2>

      <h4><a href="/dashboard/<%= org._id %>/event/<%= event._id %>"><%= event.name %></a></h4>
      <span><i class="fa fa-calendar" style="margin-right: 5px; position:relative; top:-1px; display: inline-block;"></i> <%= moment(event.date).format() %></span>

      <table class="table-reservations table table-striped">
        <thead>
          <tr>
            <th>
              Name
            </th>
            <th>
              Date &amp; time
            </th>
            <th>
              Email
            </th>
            <th>
              Seats
            </th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <% var i = 1; var s = 0; %>
          <% reservations.forEach(function(reservation){ %>
            <% if (!reservation.waiting)  { %>
            <tr>
              <td>

                <%= i %>. <%= reservation.name %> <%= reservation._id %>
                <% i = i + 1 %>
              </td>
              <td>
                <% if (reservation.timestamp) { %>
                  <%= moment(reservation.timestamp).format() %>
                <% } %>
              </td>
              <td>
                <%= reservation.email %>
              </td>
              <td>
                <%= reservation.seats %>
                <% s = s + parseInt(reservation.seats) %>
              </td>
              <td>
                <a href="/u/delete-reservation/<%= reservation._id %>" class="btn btn-danger btn-xs btn-remove-item" data-message="Are you sure you want to delete this reservation?">
                  <i class="fa fa-times-circle"></i>
                  Delete
                </a>
              </td>
            </tr>
            <% } %>
          <% });%>
        </tbody>
        <tfoot>
          <td>
            <strong>Total reserved seats :</strong>
          </td>
          <td>
            
          </td>
          <td>
            
          </td>
          <td>
            <strong><%= s %></strong>
          </td>
          <td>
            
          </td>
        </tfoot>
      </table>
      <% var waiting = false %>
      <% reservations.forEach(function(r){ %>
        <% if (r.waiting) { %>
          <% waiting = true %>
        <% } %>
      <% }) %>

      <% if (waiting) { %>
      
      <h2>Waiting list</h2>
    
      <table class="table-reservations table table-striped">
        <thead>
          <tr>
            <th>
              Name
            </th>
            <th>
              Email
            </th>
            <th>
              Seats
            </th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <% var m = 1; var ws = 0; %>
          <% reservations.forEach(function(reservation){ %>
            <% if (reservation.waiting)  { %>
            <tr>
              <td>
                <%= m %>. <%= reservation.name %>
                <% m = m +1; ws = ws + parseInt(reservation.seats) %>
              </td>
              <td>
                <%= reservation.email %>
              </td>
              <td>
                <%= reservation.seats %>
              </td>
              <td>
                <a href="/dashboard/<%= orgId %>/event/<%= eventId %>/delete/<%= reservation._id %>" class="btn-delete-reservation">
                  <i class="fa fa-times-circle"></i>
                  Delete Reservation
                </a>
              </td>
            </tr>
            <% } %>
          <% });%>
        </tbody>
        <tfoot>
          <td>
            <strong>Total waiting seats :</strong>
          </td>
          <td>
            
          </td>
          <td>
            <strong><%= ws %></strong>
          </td>
          <td>
            
          </td>
        </tfoot>
      </table>
      <% } %>
    </div>

      
    

<%- include footer %>
